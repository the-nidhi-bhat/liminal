<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Calm Hub ‚Äì Gratitude Jar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      margin:0; padding:0; box-sizing:border-box;
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Segoe UI",Roboto,sans-serif;
      -webkit-font-smoothing:antialiased;
    }

    body {
      min-height:100vh;
      background:
        linear-gradient(135deg, rgba(236,72,153,0.16), rgba(59,130,246,0.18)),
        url("image.jpg");
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      background-attachment:fixed;
      padding:24px;
      color:#0f172a;
    }

    .shell {
      max-width:900px;
      margin:0 auto;
      background:rgba(255,255,255,0.9);
      backdrop-filter:blur(22px) saturate(180%);
      border-radius:30px;
      border:1px solid rgba(255,255,255,0.9);
      box-shadow:
        0 26px 60px rgba(15,23,42,0.18),
        0 0 0 1px rgba(255,255,255,0.5) inset;
      padding:28px 26px 22px;
    }

    .top-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:16px;
      margin-bottom:18px;
      flex-wrap:wrap;
    }
    .logo-row{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .dot{
      width:20px;height:20px;border-radius:999px;
      background:radial-gradient(circle at 30% 30%,#facc15,#f97316);
      box-shadow:0 0 0 6px rgba(251,191,36,0.25);
    }
    .title-main{font-size:22px;font-weight:700;}
    .subtitle{font-size:13px;color:#6b7280;}

    .back-chip{
      padding:8px 16px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#ffffff;
      font-size:13px;
      color:#4b5563;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
      box-shadow:0 4px 10px rgba(148,163,184,0.3);
      transition: all 0.3s ease;
      cursor:pointer;
    }
    .back-chip:hover {
      transform: translateY(-2px);
      box-shadow:0 6px 14px rgba(148,163,184,0.4);
    }

    .hero{
      margin-bottom:24px;
      padding-bottom:18px;
      border-bottom:1px solid rgba(148,163,184,0.35);
      display:flex;
      justify-content:space-between;
      gap:16px;
      flex-wrap:wrap;
    }
    .hero h1{
      font-size:26px;
      font-weight:700;
      margin-bottom:6px;
    }
    .hero p{
      font-size:14px;
      color:#64748b;
      max-width:520px;
    }
    .hero-subgreeting {
      font-size:12px;
      color:#9ca3af;
      margin-top:4px;
    }

    .jar-layout {
      display:grid;
      grid-template-columns:minmax(0,2.1fr) minmax(0,1.4fr);
      gap:22px;
      align-items:flex-start;
    }

    .card{
      background:#ffffff;
      border-radius:22px;
      padding:18px 18px 16px;
      border:1px solid #e5e7eb;
      box-shadow:0 10px 26px rgba(148,163,184,0.18);
    }
    .card-header-small{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:6px;
    }
    .icon-pill{
      width:34px;height:34px;border-radius:14px;
      background:linear-gradient(135deg,#e0e7ff,#fae8ff);
      display:flex;align-items:center;justify-content:center;
      font-size:18px;
    }
    .card-title{font-size:15px;font-weight:600;}
    .card-tag{
      margin-left:auto;
      padding:2px 8px;
      border-radius:999px;
      font-size:10px;
      text-transform:uppercase;
      letter-spacing:.05em;
      background:#f3f4ff;
      color:#4f46e5;
    }
    .card p{
      font-size:13px;
      color:#64748b;
      line-height:1.5;
    }

    .label{
      font-size:12px;
      font-weight:600;
      color:#6b7280;
      margin-bottom:6px;
      text-transform:uppercase;
      letter-spacing:.05em;
    }

    .gratitude-input {
      width:100%;
      border-radius:14px;
      border:1px solid #d1d5db;
      padding:10px 12px;
      font-size:14px;
      resize:none;
      min-height:70px;
      background:#f9fafb;
      color:#111827;
    }
    .gratitude-input::placeholder{
      color:#9ca3af;
    }
    .gratitude-actions {
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:10px;
      align-items:center;
      justify-content:space-between;
    }
    .primary-btn{
      padding:8px 16px;
      border-radius:999px;
      border:none;
      background:linear-gradient(135deg,#6366f1,#8b5cf6);
      color:white;
      font-size:13px;
      font-weight:600;
      cursor:pointer;
      box-shadow:0 8px 18px rgba(99,102,241,0.35);
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .primary-btn:hover{
      transform:translateY(-1px);
      box-shadow:0 10px 22px rgba(99,102,241,0.4);
    }
    .secondary-btn{
      padding:7px 14px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#f9fafb;
      color:#4b5563;
      font-size:12px;
      font-weight:500;
      cursor:pointer;
    }
    .secondary-btn:hover{
      background:#f3f4f6;
    }

    .hint-text{
      font-size:12px;
      color:#9ca3af;
      margin-top:6px;
    }

    .jar-visual {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
    }
    .jar-svg-wrap{
      width:140px;
      height:180px;
      position:relative;
    }
    .jar-count{
      font-size:13px;
      font-weight:600;
      color:#4b5563;
    }
    .jar-sub{
      font-size:11px;
      color:#9ca3af;
      text-align:center;
      max-width:200px;
    }

    .slips-title{
      font-size:12px;
      font-weight:600;
      color:#6b7280;
      margin-bottom:6px;
      text-transform:uppercase;
      letter-spacing:.05em;
    }
    .slips-list{
      list-style:none;
      max-height:240px;
      overflow-y:auto;
      padding:0;
      margin:0;
    }
    .slip-item{
      background:#f9fafb;
      border-radius:14px;
      padding:10px 12px;
      margin-bottom:8px;
      border:1px solid #e5e7eb;
      font-size:12px;
      color:#374151;
    }
    .slip-meta{
      font-size:11px;
      color:#9ca3af;
      margin-top:4px;
    }

    .footer{
      margin-top:22px;
      padding-top:14px;
      border-top:1px solid rgba(148,163,184,0.35);
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      font-size:12px;
      color:#6b7280;
    }
    .footer a{
      color:#6366f1;
      text-decoration:none;
      font-weight:500;
    }

    @media(max-width:768px){
      body{padding:16px;}
      .shell{padding:22px 18px 18px;border-radius:24px;}
      .jar-layout{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="top-row">
      <div class="logo-row">
        <div class="dot"></div>
        <div>
          <div class="title-main">Gratitude Jar</div>
          <div class="subtitle">Collect tiny good moments in one safe place</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <button class="back-chip" onclick="window.location.href='journey.html'">‚Üê Back to Journey</button>
        <a href="welcomepage.html" class="back-chip">üè† Home</a>
        <button class="back-chip" onclick="window.location.href='gratitude-weeks.html'">üìö Weekly jar library</button>
      </div>
    </div>

    <div class="hero">
      <div>
        <h1>Drop one good thing today</h1>
        <p>Write a small note about something you‚Äôre grateful for. On heavy days, you can scroll back and read your old slips.</p>
        <div class="hero-subgreeting" id="heroSub">Tip: Even very tiny things totally count here.</div>
      </div>
    </div>

    <div class="jar-layout">
      <div class="card">
        <div class="card-header-small">
          <div class="icon-pill">ü´ô</div>
          <div class="card-title">Add a gratitude slip</div>
          <span class="card-tag">Daily</span>
        </div>
        <p>Think of something from today that felt kind, soft, funny, or simply ‚Äúnot terrible‚Äù. Turn it into one short sentence and drop it into your jar.</p>

        <div style="margin-top:12px;">
          <div class="label">What are you grateful for right now?</div>
          <textarea id="gratitudeInput" class="gratitude-input"
            placeholder="For example: ‚ÄúFriend called me when I felt low‚Äù or ‚ÄúHad a quiet 10 minutes with tea‚Äù"></textarea>

          <div class="gratitude-actions">
            <button class="primary-btn" id="addSlipBtn">
              ‚ûï Add to jar
            </button>
            <div style="display:flex;gap:8px;align-items:center;">
              <button class="secondary-btn" id="clearAllBtn">Clear jar</button>
              <button class="secondary-btn" id="randomSlipBtn">Pick a random slip</button>
            </div>
          </div>

          <div class="hint-text" id="statusHint">Saved privately in your browser. No one else can see this.</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header-small" style="margin-bottom:10px;">
          <div class="icon-pill">‚ú®</div>
          <div class="card-title">Your jar today</div>
        </div>

        <div class="jar-visual">
          <div class="jar-svg-wrap">
            <svg viewBox="0 0 100 140" width="100%" height="100%">
              <rect x="25" y="10" width="50" height="15" rx="4" ry="4" fill="#e5e7eb"/>
              <rect x="20" y="20" width="60" height="100" rx="18" ry="18" fill="#f9fafb" stroke="#e5e7eb" stroke-width="2"/>
              <rect id="jarFill" x="22" y="90" width="56" height="28" rx="16" ry="16" fill="#bfdbfe" opacity="0.8"/>
            </svg>
          </div>
          <div class="jar-count" id="jarCountLabel">0 notes in your jar</div>
          <div class="jar-sub">On a rough day, come back here and read a few slips to remind yourself of gentle moments.</div>
        </div>

        <div style="margin-top:16px;">
          <div class="slips-title">Recent slips</div>
          <ul id="slipsList" class="slips-list"></ul>
        </div>
      </div>
    </div>

    <div class="footer">
      <span>Reminder: Gratitude is not about ignoring pain, just noticing that good things still exist around it.</span>
      <span>Use alongside your <a href="journal.html">private journal</a> when you want to write more.</span>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "calmHubGratitudeJar";

    function loadSlips() {
      try {
        return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
      } catch {
        return [];
      }
    }

    function saveSlips(slips) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(slips));
    }

    function formatDateTime(date) {
      return date.toLocaleString(undefined, {
        day: "2-digit",
        month: "short",
        hour: "2-digit",
        minute: "2-digit"
      });
    }

    function renderSlips() {
      const slips = loadSlips().sort((a,b) => b.createdAt - a.createdAt);
      const list = document.getElementById("slipsList");
      list.innerHTML = "";

      slips.slice(0, 25).forEach(slip => {
        const li = document.createElement("li");
        li.className = "slip-item";
        li.innerHTML = `
          <div>${slip.text}</div>
          <div class="slip-meta">${formatDateTime(new Date(slip.createdAt))}</div>
        `;
        list.appendChild(li);
      });

      const countLabel = document.getElementById("jarCountLabel");
      const count = slips.length;
      if (count === 0) countLabel.textContent = "Your jar is empty for now";
      else if (count === 1) countLabel.textContent = "1 note in your jar";
      else countLabel.textContent = count + " notes in your jar";

      const fill = document.getElementById("jarFill");
      const maxHeight = 60;
      const baseHeight = 10;
      const ratio = Math.min(count / 20, 1);
      const height = baseHeight + ratio * maxHeight;
      const y = 120 - height;
      fill.setAttribute("height", height);
      fill.setAttribute("y", y);
    }

    function setStatus(msg) {
      const el = document.getElementById("statusHint");
      el.textContent = msg;
    }

    document.getElementById("addSlipBtn").addEventListener("click", function() {
      const input = document.getElementById("gratitudeInput");
      const text = (input.value || "").trim();
      if (!text) {
        setStatus("Write one small line before adding it to your jar.");
        return;
      }
      const slips = loadSlips();
      slips.push({
        text,
        createdAt: Date.now()
      });
      saveSlips(slips);

      const clicks = JSON.parse(localStorage.getItem("calmHubFeatureClicks") || "{}");
      clicks.gratitude = (clicks.gratitude || 0) + 1;
      localStorage.setItem("calmHubFeatureClicks", JSON.stringify(clicks));

      input.value = "";
      renderSlips();
      setStatus("Added to your jar. Come back on tough days and read a few slips.");
    });

    document.getElementById("clearAllBtn").addEventListener("click", function() {
      if (!confirm("Clear the entire gratitude jar? This cannot be undone.")) return;
      saveSlips([]);
      renderSlips();
      setStatus("Jar cleared. You can start fresh whenever you like.");
    });

    document.getElementById("randomSlipBtn").addEventListener("click", function() {
      const slips = loadSlips();
      if (!slips.length) {
        setStatus("Your jar is empty. Add one small note first.");
        return;
      }
      const random = slips[Math.floor(Math.random() * slips.length)];
      setStatus("Random slip: ‚Äú" + random.text + "‚Äù");
    });

    window.addEventListener("DOMContentLoaded", () => {
      const input = document.getElementById("gratitudeInput");
      input.focus();
      renderSlips();

      input.addEventListener("keydown", function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
          document.getElementById("addSlipBtn").click();
        }
      });
    });
  </script>
</body>
</html>
